Spring MVC (스프링 웹 MVC) 강의방향 안내

스프링 MVC의 두가지 버전

TomCat: 톰캣을 가지고 스프링없이 웹개발할수있다.
그떄는 web.xml에 설정했었는데 web.xml에다가 사용할라이브러리들을 썼다.
스프링을 쓰면 web.xml에 spring Dispatcher라는것을 쓴다.

Tomcat
Tomcat Configuration
-web.xml
	-Spring Dispatcher
	-MyBatis			//사용할 라이브러리들
	-Tiles			//사용할 라이브러리들
	-...


Tomcat
Tomcat Configuration
-web.xml
	-Spring Dispatcher
	


Spring Web
Spring Configuration
	-Servlet		|
	-Service		|
	-Security		}- XML,Annotation,java 로 설정한다.
	-MyBatis		|	
	-Tiles		|	
	-...

스프링 MVC는 프론트 컨트롤러를 제공한다.

web.xml에다가 spring Disapatcher를 올리면 스프링이 모든것을 관리하려고한다. Spring Configuration으로 mybatis,tiles등등이 옮겨지게된다.

설정하는 방법이 버전에따라서 달라졌다. 주로 현재 전자정부프레임은 xml+annotation 조금이고 현재는 Java로 Configuration하고있다. 
스프링을 가지고 개발하다보면 다 다른방식으로 개발해서 구분이 잘안되고 설정하는 것이 버전에따라서 달라서 

설정을 도와줄수있는 스프링부트가 나왔다. spring mvc를 대신하는것이아니고 설정을 모아서 편하게 설정할수있는 부가적인 프레임 워크이다. 스프링에다가 스프링부트를 얹으면 복잡한설정을 피할수있다.


Spring Boot
Starter Configuration	//Starter는 필요한것들 (servlet,service,security)등등을 묶어서 라이브러리로 가지고있다.
application.properties( 설정파일)		//일반적으로 이걸더 많이 쓰인다.
또는
YAML(설정파일)



-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Spring MVC (스프링 웹 MVC) 강의 01 - Spring MVC란

스프링이 제공하는 mvc가 무엇인지 알아보는 시간을 가지도록 하자

model1:컨트롤러가 개념적으로 존재, 그것을 출력을 담당하는 부분이 하나로 뭉쳐짐
 model2: 두개를 나누고, 컨트롤러는 서블릿으로 구현, jsp를 템플릿화면으로 뷰로 사용

dispatcher를 이용해서 포워딩을 했다. 모든 컨트롤러는 dispatcher기능을 다 구현해야하고 모든 컨트롤러에다가 가지고있는것은 비효율적인것 같다.
그래서 순수하게 컨트롤러 기능만 POJO로 구현할것이다. (Plain old java object) 평범한 자바 객체

컨트롤러가 빠진 Dispatcher가 남는다.
Dispatcher는의 기능은 view로 포워딩하는 기능이기때문에 기능이 거의다 똑같다. 그래서 Dispatcher하나만 둘수있다.

1. Dispatcher가 controller에게 사용자에게서 온 요청을 전달하고
2. 요청을 해서 결과물을 받아서 View로 전달

그런데 이 과정이 간단하지만은 않다. Dispatcher의 역할이 굉장이 중요하다.
사용자의 요청을 받는다는것은 단순하게 요청을 라우팅하는 역할이아니라 사용자가 전달하는 입력값이있으면 입력값을 Controller에게 사용하기 쉽게 포장해서 줄수도있다.
쉽게 포장해서주면 지금까지 했던것 servlet 이용해서 get 파라미터 이렇게 이용하는게 아니라 서블릿의 기능을 다차단할수있다.
Controller 에 기본적으로 사용할수있는 String int 등등으로 전달이 가능하다.

두번째는 단순하게 기본형으로 전달하는게아니라 어떤데이터를 개체화하는데 notice형 student형 등등으로 담아줄수있다. 서블릿라이브러리를 하나도 쓰지않고 입력을 처리할수있거나
Controller에서 말해놔서 view에 전달할때도 Controller에는 dispatcher기능이없다. 리턴할때 어떤 뷰페이지가 필요하다 라는 정보만 알려주면 Dispatcher가 View를 호출하면서 서블릿 기능을 Dispatcher로 한정할수있다.

이게바로 Dispatcher를 따로 분류하는 이유이다.

 Dispatcher와 Controller 결합력을 낮추게 함으로써 다른환경에서도 사용할수있게끔 하려고 한다.


Dispatcher를 만드는게 중요한데 Dispatcher만드는것을 스프링이 제공했다. 프론트컨트롤러를 잘만들게되면 톰캣과 이별할수도있다.



서블릿 디스패처 스프링이 제공한다.
모든 url요청이 오는데 적절하게 알맞은 컨트롤러에게 전달해야가기때문에  url을 어떤 controller가 처리할지를 가지고있어야한다. 설정파일이 필요하다. 과거에는 web.xml에서 설정하거나 annotation으로 설정했지만 
현재는 servlet.xml에 매핑정보를 쓰게된다.
스프링을 이용해서 컨트롤러를 이용하겠다는 것이다.

스프링 mvc는 라이브러리를 쓰는것인데 spring-webmvc에 있다.


-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Spring MVC (스프링 웹 MVC) 강의 02 - 실습환경 준비하기

스프링MVC를 실습을 통해서 MVC라이브러리를 쓰려면 실습환경을 준비해야한다.
실습환경
톰캣
jdk

개발환경도구
Spring에서 제공하는 개발환경도구

브라우저를 열고 spring.io접속 
그리고 사용할것은 spring Tools 4 for Eclipse를 다운하자 이 도구를 꼭 사용해야하는건 아니다. 설치하지않아도 라이브러리를 쓰면된다.
최신버전을 다운로드하자

다운로드해서 압축을 풀고 contents.zip을 잘라내기해서 tools(도구들 넣는 폴더) 에다가 sts-4.10.0.RELEASE를 넣어준다.

톰캣도 최신버전을 다운로드하자. 압축되있는 버전

부트를 사용하면 톰캣도 없어도 된다.
부트를 가지고 개발해도 좋으나


-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Spring MVC (스프링 웹 MVC) 강의 03 - 메이븐을 이용한 기본 웹 프로젝트 생성하기


지난시간에 spring web project를 만들기위해 실행환경으로써 톰캣을 다운받았고, 프로젝트를 개발하기 위해서 사용되는 스프링툴스를 받았다.
이것을 이용해서 빈프로젝트(스프링 배제하고 ,maven기반) 으로 만들고 다음시간에 spring을 다음시간에 얹는 작업을 할것이다.

프로젝트를 만들때 Create new Spring Starter Project는 스프링 부트를 기반으로 해서 만드는 프로젝트인데 스프링에 스프링부트를 얹은녀석이다.

오늘은 기본적인 웹프로젝트를 만들것이다. perspective -> javaEE-> Create a Maven project

Create a simple project(skip archetype selection) 체크
Use default Workspace location 체크

다음
packaging: war 로 변경

만들어지면 pom.xml에 빨간줄이 그어진다.  에러메세지는 web.xml이 없어서 에러가난것이다. web.xml 은 어디에 둬야하는가?
webapp안에 webinfo를 만들고 그안에다 둘것이다.


apache-tomcat-9.0.38/webapps/ROOT/WEB-INF 를 복사해서 src/main/webapp 에다가 넣어주면 된다. 이렇게 붙여넣어주면 pom.xml에 에러가 사라진다.

java resources를 보면 jdk가 1.5로 되어있다. pom.xml 에서 overview 로 가서 properties에서 create에서 Name: maven.compiler.source Value:1.8
로적어주면 추가가된다. 그리고 복사해서 붙여넣어서

 <maven.compiler.source>1.8</maven.compiler.source>		//1.8쓸거고
 <maven.compiler.target>1.8</maven.compiler.target>		//대상도 1.8버전이다.
그리고 보면 안바뀌어있다. pom.xml에 변경사항이 생긴다면 프로젝트에서 오른쪽 클릭을하고 maven-> update Project라는 버튼을 누르자
update를 하고나면 제대로 바뀌었다.

jsp 파일을 추가 할것인데 preference->Web->JSP Files
Korean,EUC-KR을 ISO 10646/Unicode(UTF-8)로 바꿔주도록 하자

html,css도 똑같이 바꿔주자

프로젝트->Properties->Resource-> 인코딩을 UTF-8로 바꿔주자

web-app 아래에 jsp파일을 추가해주면에러가난다. 왜 에러가나냐면? jsp 관련된 톰캣라이브러리가 없어서 그렇다.

pom.xml에 추가할것인데 구글에서 maven tomcat api 를 검색해서 톰캣 버전에맞게 클릭을 하면 코드가 뜨는데 그것을 복붙해주면된다.

-pom.xml
	.....	
	.....
  <packaging>war</packaging>
  <dependencies>
  <!-- https://mvnrepository.com/artifact/org.apache.tomcat/tomcat-api -->
	<dependency>
    	<groupId>org.apache.tomcat</groupId>
    	<artifactId>tomcat-api</artifactId>
    	<version>9.0.41</version>
	</dependency>
  </dependencies>
  <properties>
  	<maven.compiler.source>1.8</maven.compiler.source>
 	<maven.compiler.target>1.8</maven.compiler.target>
  </properties>
</project>

이렇게 하면 JSP파일에 에러가 사라진다. 
그리고 JSP 를 실행하면 실행환경이 구축이 안되어있다. apache Tomcat9.0을 설정하자
그리고 톰캣폴더를 지정해주자

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Spring MVC (스프링 웹 MVC) 강의 04 - Dispatcher Servlet 라이브러리 설정하기

maven 프로젝트를 만들어봤는데 그 프로젝트 위에 maven을 얹어 보도록해야겠다. 얹는다는것은 스프링이 프론트컨트롤러를 제공해
 그 프론트 컨트롤러 역할은 무엇인지 알아보는것도 중요하다.

Dispatcher에다가 Servlet관련된것을 넣고
Controller에 POJO를 만들것이다.

Dispatcher는 어떻게 구할것이냐? spring-webmvc 라이브러리안에 DispatcherServlet 이라는 클래스를 다운로드해야한다.
maven을 이용하게될경우 다운로드할경우 pom파일로 다운이 가능하다.

다운로드방법
1. 페이지방문해서 다운로드
2. window 메뉴-> show view-> maven repository-> Global Repository-> Rebuild index 또는 Update index 둘중에 하나를 선택하면 원격에있는 라이브러리를 가져온다.

원격에있는 저장소에 있는 라이브러리 목록으로 가져올수있다. 라이브러리를 가져오는것이 아니다.

Rebuild해놓으면 꽤 시간이 걸린다.  다음부터 다운받을 일이있으면 원격저장소에 index를 가지고 쉽게 추가할수있다.
Dependencies라는 탭이있다. Dependecies에 보면 유저인터페이스가 그래픽하게 보여진다.
Add를 눌러서 검색이 가능하다. 검색을 해서 라이브러리를 다운받을수 있는데 검색에있는 목록이 원격에있는게 아니라 인덱싱을한 내용가지고 검색을한다.

다운로드하면 원격에서 다운로드해서 가져온다.
일단은 인덱싱이 안되었기 때문에 페이지에가서 다운로드 받자.
https://mvnrepository.com 에서 spring framework 검색-> spring web클릭하고 최신버전을 다운해도 가능하지만

Spring Web MVC를 다운받으면 Spring Web이 필요하다 필요하게되면 자동으로 다운받아지니 Spring Web MVC의 최신버전을 다운받자
다운로드가 다되면 Libraries를 열어보면 JRE Maven Dependencies 두개가 있다.

pom.xml에 설정했던내용을 Maven Dependencies에 포함이되어있다. Maven을 쓰는 가장 중요한 이유는 하나를 다운받으면 그것에 필요한 Dependencies를 다운받아준다는것이다.

지금우리는 tomcat-api 와 spring-webmvc 두개만 다운로드했었는데 maven이 필요하니까 계층적으로 하위 라이브러리까지 다운로드해줬다.

maven을 쓰지않고 직접쓴다면 관련성있는 라이브러리 찾는것도 굉장히 오래걸린다. maven 덕분에 굉장히 쉽게 라이브러리 추가가 가능해졌다.
spring-webmvc 아래 servlet아래에 DispatcherServlet 이라는 클래스에다가 Copy qualified name을 하게되면 패키지명과 클래스명을 한번에 복사가 가능하다. 


-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Spring MVC (스프링 웹 MVC) 강의 05 - dispatcher-servlet.xml 파일

지난시간에 스프링을 사용하기 위한 라이브러리를 다운받아놨는데 그것을 이용해볼것이다.
그러기위해서는 스프링에서 제공하고있는 컨트롤러가 있는데 그 컨트롤러와 프론트 컨트롤러다. 그것을 사용하기위해 가장 중요한것은
dispatcher-servlet.xml이라는 xml파일이다.
 
xml파일의 의미와 용도를 알아보자

기본적인 mvc는 꼭 spring이 있어야하는건 아닌데 스프링없이 mvc를 구현하려고하면 컨트롤단이있어야하고 컨트롤 단에서 만들어낸 데이터를 가지고 화면을 출력해야한다.
index.jsp를 view라고 하고 모델을 컨트롤러가 심어서 전달을 해주면 모델데이터를 출력하는것을 해보자.

-index.jsp

<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
	<h1>Hi ${data}</h1>
</body>	
</html>

기본적으로 컨트롤러를 만든다고 하면 그냥 클래스를 만들어서  extends HttpServlet 해도 되는데 
서블릿의 기능을 분리해서 누가 가져가냐? spring-mvc에서 Dispatcher-servlet.xml이 그역할 가져갈것이다.

컨트롤러를 POJO로 만들고 Dispatcher는 만들어져있는거라서 annotation으로 url 매핑을 할수가없다.

Dispatcher에다가 url매핑을 해야하는데 어디서하냐면 web.xml에다가한다.

-web.xml

<?xml version="1.0" encoding="UTF-8"?>

<web-app xmlns="http://xmlns.jcp.org/xml/ns/javaee"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee
                      http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"
  version="4.0"
  metadata-complete="true">

	<servlet>	<!--서블릿 설정할 클래스는 dispatcherServlet인데  -->
		<servlet-name>dispatcher</servlet-name>
		<servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
	</servlet>
	<servlet-mapping><!-- 서블릿을 사용자가 요청할 수 있게끔 하는 매핑 주소가 있어야한다.  -->
		<servlet-name>dispatcher</servlet-name>
		<url-pattern>/</url-pattern><!-- 주소를 쓰는데 프론트 컨트롤러여서 모든 /로 시작하는 url을 받을것이다. 각각의 포조클래스를 분배해주게 되어있다. -->
	</servlet-mapping>

  <display-name>Welcome to Tomcat</display-name>
  <description>
     Welcome to Tomcat
  </description>
</web-app>

이렇게하면 서비스 설정 끝난것이다.

Hi라는 페이지가나온다. 우리가 원했던건 프론트 컨트롤러 를 만들었다. 모든 주소를 받아들이고 어떠한 요청이와도 프론트컨트롤러가 매핑하지않은 url은
url은 나오면 안된다. 이거는 안되는것이다

뭐가잘못된것이냐면

<url-pattern>/</url-pattern> 모든것이 통과한다. 
<url-pattern>/*</url-pattern>//어떤 url도 허락하지않으면 통과하지않는다. 로 바꾸고 실행을 해보자

web-INF안에 Dispatcehr 서블릿이 없다는 에러가 나온다.


disapatcher를 이용하려고 하는데 서블릿으로 설정했고 모든 URL에 대해서 받겠다. index.jsp라고 요청이왔는데 적절한 url에 맞는 리소스를 배분해줘야하는데
매핑정보가 필요하다. *-servlet.xml 이 약속되어있는 위치에 있어야한다. 기본위치는 -servlet.xml이 있어야한다.
설정파일이없으니까 매핑할수도없었다.

그렇다면 WEB-INF/dispatcher-servlet.xml 파일을 만들자.

그리고 이파일에다가는 무엇을 넣어야할까 다음시간에 알아보자

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Spring MVC (스프링 웹 MVC) 강의 06 - 스프링 컨트롤러 IndexController 작성하기

지난시간에 스프링이 제공하는 mvc를 지원한 라이브러리인 dispatcher 라이브러리 그 녀석이 사용하는 설정파일이있다.
그것이 바로 dispatcher-servlet이라는 파일인데 그것을 작성하고 indexController를 POJO 기반으로 스프링의 도움을 받아서 작성해보도록할것이다.

어떤 구문으로 어떻게 작성할수있는지 알수없다. dispatcher를 만든 스프링에서 레퍼런스를 참조해야한다.

https://docs.spring.io/spring-framework/docs/

core를 클릭하고 

<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
        https://www.springframework.org/schema/beans/spring-beans.xsd">

    <bean id="..." class="...">  // beans:어떤 클래스를 설정하면 얘를 객체화해서 스프링컨테이너에 담게 된다. id는 class를 꺼내서 사용할떄쓰는건데 mvc는 다르게 사용한다 . url을 쓴다.
        <!-- collaborators and configuration for this bean go here -->
    </bean>

    <bean id="..." class="...">
        <!-- collaborators and configuration for this bean go here -->
    </bean>

    <!-- more bean definitions go here -->

</beans>
를 복붙해서 넣어주면된다. 

<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
        https://www.springframework.org/schema/beans/spring-beans.xsd">

    <bean id="/index" class="com.newlecture.web.controller.IndexController">		//mvc는 스프링이기떄문에 컨테이너에 담겨진것을 사용한다. /index라는url 요청이오면 com.newlecture.web.controller.IndexController를 객체화해서 호출한다. 
        <!-- collaborators and configuration for this bean go here -->
    </bean>

</beans>

남아있는 spring에 dispatcher라는 클래스(프론트 컨트롤러)가 컨테이너에서 꺼내가지고 얘가 가지고있는 기능을 호출해주는것만 남았는데
그걸 하기위해서 두가지를 해야한다. url 과 컨트롤을 매핑한 정보를 id라는 것을 이용해서 url을 쓰게 되어있는데 이게 bean이라고 하는걸 등록이 되면 컨텐츠가 담겨지는것이다.
Controller에는 POJO 형식으로 만들어놓은 녀석들이 있는데,  Dispatcher에서 Controller를 사용하려면 약속되어있는 어떤게 있어야할것같다.

사용자가 index요청을 했으면 요청에 수반할수있는 함수가있어야한다. 그함수명은 약속이되어있어야하나?
그렇다 그것은 handleRequest이다. Dispatcher가 제공하는 약속이 인터페이스가 있다. 그것을 구현해야한다.

약속을 수반하는 인터페이스를 구현해야한다.


모델앤뷰라는 녀석이 반환되면 dispatcher에게 가고 dispatcher가 포워딩해서 뷰를 찾아서 모델을 전달  view에서 그모델을 사용해서 사용자에게 출력한다.

실행해보면 404에러가 난다. 톰캣의 어노테이션쓸려면 매핑주소를 읽어서 요청해주는데, 톰캣이 모르는  POJO클래스니까 클래스가아니까 소스코드로 반환하는일이 발생한다.
우리가 원하는건 url매핑된 정보이다. 그래서 http://localhost:8080/webprj/index 를 요청하면 잘될까?

안된다. 왜 안되냐면 web.xml에 보면 url매핑했던부분 <url-pattern>/*</url-pattern> 이 문제다.
*를 쓰면 포워딩이든 get요청을 하든 DispatcherServlet를 다시거쳐가야한다. index를 거쳐서 com.newlecture.web.controller.IndexController를 요청을 했는데
dispatcher-servlet.xml 에 index.jsp의 내용이 없어서 에러가 발생한다. 그래서
<url-pattern>/</url-pattern> 별을 뺀다.

DispatcherServlet를 거치기는 하지만 리소스에서 찾아보지만 없으면 리소스에 직접 요청하게해준다. 잘 나왔따. 처음부터 그럼 별을 빼면되는데 왜안뻈을까 다음시간에 알아보자

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Spring MVC (스프링 웹 MVC) 강의 07 - View 페이지를 위한 위치

index 컨트롤러를 만들어봤는데, 그러면서 web.xml에서 url 매핑에대해서 이야기했는데, *를 지우면 문제가 발생하는것도 이야기했었다. 그 이야를 해볼것이다.

*을 지우면 문제가된다. controller가 있고 view가 있다. controller와 view가 분리되어 있을경우 실제 어플리케이션은 하나이다.
사용자요청이 왔을떄 controller따로 view 따로 정할수 있는것이아니라 무조건 controller만 요청하게 해야한다. 프로그래밍은 절차가 중요하다.

실행되는 순서로봤을때 controller가 위고  view 아래이다. 그렇다면 사용자가 view만 요청하면 안되는것이다. 원래하나인데 유지관리 편하게하기위해 자바코드를 뺀것이다. 

index.jsp 에서 ctrl+F11눌러서 실행해보면 실행이된다. 이러면 문제가 있는것이다. 사용자가 얘를 요청할수 없게끔 해야한다.
그렇다면 <url-pattern>/*</url-pattern> 을 다시 복구할것인가 이것도 문제가있다. mvc를 구현한사람들은 어떻게 해결하냐면
view페이지를 요청할수 없게끔 숨겨놓는 작업을 한다. 사용자가 직접요청할수없는 영역이있다. 

WEB-INF 안에 view라는 폴더를 만들자(폴더이름 상관없음) 그리고 index.jsp를 view라는 폴더안에다가 넣게된다면 사용자가 직접적으로 index.jsp를 요청할수 있는 방법이 없다.
얘는 비공개영역이라서 접근할수없다.
그렇다면 컨트롤러에서도 이용할수 없으면 안되니까 다행스럽게도 컨트롤러에서는 요청할수있다.클라이언트 쪽에서 요청하는것이 불가능한것이지 서버쪽에서 파일요청은 가능하다.

-IndexController.java

mv.setViewName("index.jsp");
부분을
mv.setViewName("/WEB-INF/view/index.jsp");
로 바꿔주면된다. 이렇게 설정하면 긴문자열이 마음에 안드는데 다음시간에 설정하는 방법을 알게될것이다.
이제 view페이지는 컨트롤통해서만 요청이가능하다.
잘 나온다.

mvc를 가지고 프로그램만들떄 혼란스러운것은 404가 많이난다는것이다. 

-IndexController.java
mv.setViewName("/WEB-INF/view/index.jsp"); 		->		mv.setViewName("WEB-INF/view/index.jsp");

에러가 나지않는다. index가 가지고있는 url에 맞춰서 상대적인 url을 갖는것이다.

-dispatcher-servlet.xml
 <bean id="index" class="com.newlecture.web.controller.IndexController">  	=>	<bean id="/aa/index" class="com.newlecture.web.controller.IndexController">  
실제로 aa라는 폴더가 존재하지않는다.파일도없다.  com.newlecture.web.controller.IndexController의 이름일 뿐이다.

WEB-INF/view/index.jsp 상대경로로 적었는데 이렇게 쓰면 현재 이 컨트롤러가 가지고있는 url은 http://.../aa/index로 본다. 그래서 WEB-INF와 같은 위치에 있다고보고
그래서 /를 뺴면  http://.../aa/ 에서 WEB-INF를 찾는다. http://.../aa/WEB-INF

그러니까 오류가 발생한다. view를 찾을떄는 절대경로를 쓰면된다. /에서 WEB-INF를 찾게된다.
상대경로쓰면 힘드니 절대경로 쓰는게 낫다.

<bean id="/index" class="com.newlecture.web.controller.IndexController">  		//여기도 /를 붙여야한다.
        <!-- collaborators and configuration for this bean go here -->
 </bean>


http://localhost:8080/webprj/index 여기서 webprj는 무엇일까? 프로젝트명이다. 프로젝트명은 원래 들어가면안된다. 컨텍스트명을 붙인것이다. 현재 프로젝트가 컨텍스트명을 가질필요가없다.
프로젝트 오른쪽클릭-> properties-> Web Project Settings
컨텍스트명을 /로 변경할것이다. 컨텍스트명을 변경하면 Servers에서 SNAPSHOT을 지워야한다.

이제 Index Controller를 열어서 실행하면 될까 안될까? 안된다. 이클립스가 브라우저를 띄워준다. 이클립스가 적당한 요청 url을 입력해주면서 창을 띄주는데
이제 그런것이 불가능해진다. 약간 편법을 쓰게되면 index라는 파일이 현존하는것이아니다. 파일이없으니까 src에 main에다가 매핑주소가 똑같은 빈파일을 만들어보자
실행이된다. index 빈파일을 요청한것이 아닌데 이클립스한테 요청하면 이클립스는 파일명과 동일한 이름의 url을 입력해준다.
http://localhost:8080/index 그런데 하필 동일하게 매핑된 주소가 있는데 컨트롤러가 우선순위가 더 높기 떄문에 컨트롤러에 부합되는 디스패치가 일어나서 된것이다.


-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Spring MVC (스프링 웹 MVC) 강의 08 - ViewResolver 사용하기

지난시간에 뷰페이지를 WEB-INF안에 view로 옮겼다. 그렇게 함으로써 뷰페이지를 찾는 방법이 복잡해졌다. 왜냐면 WEB-INF를 붙여야하고 view라는 폴더도 있으니까
그래서 복잡해졌기때문에 쉽게 찾을수 있도록 ViewResolver라는 녀석을 사용할것이다.

-IndexController.java

ModelAndView mv = new ModelAndView("/WEB-INF/view/index.jsp");

컨트롤러 만드면서 view페이지를 WEB-INF에 둠으로써 찾는방법이 복잡해진것이다. 그래서 보면 지난시간에 다뤘던 내용에서는 ModelAndView를 기본생성자로 만들고
jsp라고하는 페이지가 있는 그 경로가 setViewName이라고하는 세터를 이용해서 설정했는데 오버로드된 생성자 이용해서도 설정을 많이한다.(오버로드 방법을 더 많이씀)
1. 세터 설정방법
ModelAndView mv = new ModelAndView();
mv.setViewName("/WEB-INF/view/index.jsp");

2.오버로드 생성자 설정 방법
ModelAndView mv = new ModelAndView("/WEB-INF/view/index.jsp");

경로를 쓰는방법이 복잡해졌다. IndexController 하나에서만 쓰는게 아니라 다른것도 써야한다.
어떻게 해야하냐면 /WEB-INF/view/    .jsp 를 빼고  view페이지인 index만 쓸수있게해야한다.

-IndexController.java

ModelAndView mv = new ModelAndView("index");

그러면 모든컨트롤러가 깔끔하게 쓸수있다. 그러면 index만 반환해서 디스패처가 받으면 그런리소스가 없으니 404나는게 아니냐?
전달된거에다가 /WEB-INF/view/    .jsp 를 붙여서 찾게 해주는것이 viewResolver이다.
앞뒤에 붙여서 실제적인 view페이지를 찾을수있게 해주는 능력자이다.

dispatcher-servlet.xml 에 ViewResolver를 설정하도록하자.

org.springframework.web.servlet.view.InternalResourceViewResolver 를 스펠링이 틀릴수가 있으니 java파일에서 ViewResolver를 찾아서 import 시키고 그것을 복붙해오자

-dispatcher-servlet.xml 

<bean class="org.springframework.web.servlet.view.InternalResourceViewResolver">
	<property name="prefix" value="/WEB-INF/view/"></property>
	<property name="suffix" value=".jsp"></property>
</bean>

해주면 제대로 동작한다.


-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------



